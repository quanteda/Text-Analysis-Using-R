<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Text Analysis Using R - 9&nbsp; Creating and Managing Corpora</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./10-quanteda-tokens.html" rel="next">
<link href="./08-quanteda-overview.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Creating and Managing Corpora</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Text Analysis Using R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/quanteda/Text-Analysis-Using-R" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-preface.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-authors.html" class="sidebar-item-text sidebar-link">About the Authors</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction and Motivation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-r-basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-r-workflow.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-r-strings.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with Text in R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Acquiring Texts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-acquiring-files.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with Files</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-acquiring-packages.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Using Text Import Tools</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-acquiring-internet.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Obtaining Texts from the Internet</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Managing Textual Data Using quanteda</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-quanteda-overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introducing the <strong>quanteda</strong> Package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-quanteda-corpus.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Creating and Managing Corpora</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-quanteda-tokens.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Creating and Managing tokens</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-quanteda-tokensadvanced.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Advanced Token Manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-quanteda-dictionaries.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Creating and Managing Dictionaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-quanteda-dfms.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Building Document-Feature Matrices</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Exploring and Describing Texts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-exploring-description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Describing Texts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-exploring-kwic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Keywords-in-Context</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-exploring-dictionaries.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Applying Dictionaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-exploring-frequencies.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Most Frequent Words</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Statistics for Comparing Texts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-comparing-sophistication.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Profiling Lexical Patterns and Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-comparing-documents.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Document Similarity and Distance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-comparing-features.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Feature Similarity and Distance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Machine Learning for Texts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-ml-supervised-scaling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Supervised Document Scaling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-ml-unsupervised-scaling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Unsupervised Document Scaling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-ml-classifiers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Methods for Text Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-ml-embedding.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Word Embedding Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-ml-topicmodels.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Topic modelling</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Further Methods for Texts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-further-advanced-nlp.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Advanced NLP using R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-further-tidy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Integrating “tidy” approaches</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./28-further-hardlanguages.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Text analysis in “Hard” Languages</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./29-appendix-installation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Installing the Required Tools</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30-appendix-encoding.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Everything You Never Wanted to Know about Encoding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31-appendix-regex.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">A Survival Guide to Regular Expressions</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="toc-section-number">9.1</span>  Objectives</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="toc-section-number">9.2</span>  Methods</a></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications"><span class="toc-section-number">9.3</span>  Applications</a>
  <ul class="collapse">
  <li><a href="#creating-a-corpus-from-different-input-sources" id="toc-creating-a-corpus-from-different-input-sources" class="nav-link" data-scroll-target="#creating-a-corpus-from-different-input-sources"><span class="toc-section-number">9.3.1</span>  Creating a Corpus from Different Input Sources</a></li>
  <li><a href="#inspecting-document-level-variables-and-metadata-of-a-corpus" id="toc-inspecting-document-level-variables-and-metadata-of-a-corpus" class="nav-link" data-scroll-target="#inspecting-document-level-variables-and-metadata-of-a-corpus"><span class="toc-section-number">9.3.2</span>  Inspecting Document-Level Variables and Metadata of a Corpus</a></li>
  <li><a href="#subsetting-a-text-corpus" id="toc-subsetting-a-text-corpus" class="nav-link" data-scroll-target="#subsetting-a-text-corpus"><span class="toc-section-number">9.3.3</span>  Subsetting a Text Corpus</a></li>
  <li><a href="#randomly-sample-documents-from-a-corpus" id="toc-randomly-sample-documents-from-a-corpus" class="nav-link" data-scroll-target="#randomly-sample-documents-from-a-corpus"><span class="toc-section-number">9.3.4</span>  Randomly Sample Documents From a Corpus</a></li>
  </ul></li>
  <li><a href="#advanced" id="toc-advanced" class="nav-link" data-scroll-target="#advanced"><span class="toc-section-number">9.4</span>  Advanced</a>
  <ul class="collapse">
  <li><a href="#corpus-cleaning" id="toc-corpus-cleaning" class="nav-link" data-scroll-target="#corpus-cleaning"><span class="toc-section-number">9.4.1</span>  Corpus “Cleaning”</a></li>
  <li><a href="#the-structure-of-a-quanteda-corpus-object" id="toc-the-structure-of-a-quanteda-corpus-object" class="nav-link" data-scroll-target="#the-structure-of-a-quanteda-corpus-object"><span class="toc-section-number">9.4.2</span>  The Structure of a <strong>quanteda</strong> Corpus Object</a></li>
  <li><a href="#conversion-from-and-to-other-formats" id="toc-conversion-from-and-to-other-formats" class="nav-link" data-scroll-target="#conversion-from-and-to-other-formats"><span class="toc-section-number">9.4.3</span>  Conversion from and to Other Formats</a></li>
  <li><a href="#converting-or-coercing-to-other-object-types" id="toc-converting-or-coercing-to-other-object-types" class="nav-link" data-scroll-target="#converting-or-coercing-to-other-object-types"><span class="toc-section-number">9.4.4</span>  Converting or Coercing to Other Object Types</a></li>
  <li><a href="#changing-the-unit-of-analysis" id="toc-changing-the-unit-of-analysis" class="nav-link" data-scroll-target="#changing-the-unit-of-analysis"><span class="toc-section-number">9.4.5</span>  Changing the Unit of Analysis</a></li>
  <li><a href="#reshaping-corpora-after-statistical-analyis-of-texts" id="toc-reshaping-corpora-after-statistical-analyis-of-texts" class="nav-link" data-scroll-target="#reshaping-corpora-after-statistical-analyis-of-texts"><span class="toc-section-number">9.4.6</span>  Reshaping Corpora after Statistical Analyis of Texts</a></li>
  </ul></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="toc-section-number">9.5</span>  Further Reading</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">9.6</span>  Exercises</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/quanteda/Text-Analysis-Using-R/edit/master/09-quanteda-corpus.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-quanteda-corpus" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Creating and Managing Corpora</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="objectives" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">9.1</span> Objectives</h2>
<p>In this chapter, we cover the corpus object. We explain why you need a text corpus for text analysis and how the selection of texts can affect your results and inferences. We also outline approaches for changing the unit of analysis (reshaping and segmenting corpora), how to filter a text corpus based on variables associated with texts, how to retrieve the raw texts from a text corpus, and how to manage metadata about a text corpus.</p>
</section>
<section id="methods" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="methods"><span class="header-section-number">9.2</span> Methods</h2>
<p>Text analysis projects involve choices about the texts to be analyzed. Texts are collected in a <em>text corpus</em>. Text corpora usually consist of three elements: the texts, document-level variables, and metadata about the corpus overall.</p>
<p>Creating a text corpus starts with defining a sample of the available texts, out of all possible texts you could have selected. A text corpus could include all articles published on immigration in Irish newspapers, with each article recorded as one <em>document</em> in the text corpus. A corpus could also be the reviews about one specific hotel, or a random sample of reviews about hotels in Europe. Researchers need to consider and justify why certain texts are (not) included in a corpus, since the generalisability and validity of findings can depend on the documents selected for analysis.</p>
<p>The principles of your specific project or research design should guide your decisions to include or exclude of documents for analysis. For example, if you want to study rhetoric during televised debates, the corpus would be limited to transcripts of televised debates. When comparing issue salience in televised debates and campaign speeches, the corpus will contain debate transcripts and speeches. Thus, the research question should drive document selection.</p>
<p>In some text analysis applications, the sample could constitute the entirety of texts. Analysing all texts released by the actor(s) of interest does not necessarily mean that an analysis is without problems. Selection issues can drive the information that is recorded. Texts or information not transcribed or published cannot be included in the analysis. When analysing budget speeches, speaker selection is an important caveat. Parties strategically select Members of Parliament who can express their opinion on government policy and budget decisions <span class="citation" data-cites="herzog15cuts">(<a href="references.html#ref-herzog15cuts" role="doc-biblioref">Herzog and Benoit 2015</a>)</span>. The positions of politicians not selected for speaking at a budget debate cannot be considered in the textual analysis. Researchers should therefore consider potential selection effects or systematic missingness of information when assembling a text corpus.</p>
<div class="callout-note callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Including and comparing texts with very different characteristics may affect your analysis. For example, written speeches often differ from spoken speeches <span class="citation" data-cites="benoit19sophistication">(<a href="references.html#ref-benoit19sophistication" role="doc-biblioref">Benoit, Munger, and Spirling 2019</a>)</span>. Debates follow a different data-generating process than campaign speeches. Debates rely on questions and spontaneous responses, while politicians or their campaign teams draft campaign speeches well in advance. This does not mean that different types of text cannot or should not be compared since such a comparison can reveal structural differences based on the medium of communication. However, we would strongly advise you to identify structural differences between types of texts by comparing different groups of texts. We discuss how to differences in word usage across groups in <a href="17-exploring-frequencies.html"><span>Chapter&nbsp;17</span></a>. <a href="25-ml-topicmodels.html"><span>Chapter&nbsp;25</span></a> shows how to identify variation in topic prevalence for two or more groups of documents.</p>
</div>
</div>
</div>
<p>Besides the raw text, corpora (usually) include attributes that distinguish texts. We call these attributes <em>document-level variables</em> or, in the language <strong>quanteda</strong>, “docvars”. Docvars contain additional information on each document and allow researchers to differentiate between texts in their analysis. Document-level variables could be the name of the author of a text, the newspaper in which an article was published, the hotel which was reviewed on TripAdvisor, or the date when the document was created.</p>
<p>A text corpus also typically contains <em>metadata</em> recording important information about the corpus as a whole. Metadata that is generally useful to record in a corpus include the source where the corpus was obtained, including possibly the URL; the author of the corpus (if from a single source); a title for the corpus; and possibly important keywords that might be used later in categorising the corpus. Corpus metadata can be quite general, including a codebook, instructions how to cite the corpus, or a license for the use of the corpus or copyright information.</p>
<div class="callout-tip callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>While there no universal standard exists for which metadata to record, there are guidelines for corpus objects that are followed in the <strong>quanteda</strong> packages that provide example corpora, including those in the package that accompanies this book. These all record the following metadata fields: <em>title</em> and <em>description</em>, providing a title and short text description of the corpus respectively; <em>source</em> and <em>url</em>, documenting in plain text and as a web address where the corpus was obtained; <em>author</em>, even when there was no single author of the documents; and <em>keywords</em>, a vector of keywords categorising the corpus. We recommend using this scheme for new corpus object that you create.</p>
</div>
</div>
</div>
<p>Just in the decision to selecting which documents should be included in the corpus, the text analyst must also think carefully about what will define a document. Sometimes, this decision is natural, such recording individual product reviews, individual speeches (as in the Presidential inaugural speech corpus), or individual social media posts. Because the definition of a document can be fluid, however, not all such decisions are so clear cut. A user might wish to cut some longer documents into sub-sections (like chapters of a book, or paragraphs of a speech) that will form documents. Or, when facing lots of smaller texts such as posts on Twitter, a user might wish to aggregate these by user, or by day or week, to define new documents. As with the decision to select texts for a corpus, the decision as to precisely how documents should be defined will depend on a user’s needs for a specific project. Sometimes, this will produce a need to redefine the document units in which texts were collected, into document units that resemble the units that the user will analyse for the purposes of a broader study. In their study about the association between emotions and real-time voter reactions, for instance, <span class="citation" data-cites="boussalis21reactions">Boussalis et al. (<a href="references.html#ref-boussalis21reactions" role="doc-biblioref">2021</a>)</span> redefine the speech unit of documents in which campaign speeches where found, into specific utterances that were later analysed as specific statements associated with variable levels of sentiment. In reviews of hotels, the unit could be an individual review of a hotel, the mention of the hotel and its immediate context, or all texts that review a hotel. The point is that the document units in which texts are collected may not be the same as the document units that a text researcher will need for the purposes of their analysis. In the section that follows, we will show to reshape, split, and combine document units from a corpus that allow a flexible redefinition of document-level units to meet specific analytic needs. We also cover how to access and modify all elements of the corpus mentioned in this section.</p>
<div class="callout-important callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Some tools for text analysis call for “cleaning” a corpus, sometimes by removing elements that are deemed to be unwanted, such as punctuation. We strongly discourage this, because such radical interventions lessen the generality of a corpus. We take the same approach to defining documents: We prefer that a corpus contain <em>natural</em> units of analysis, such a individual reviews, rather than <em>analytic</em> units of analysis such as combined or aggregated reviews. <a href="11-quanteda-tokensadvanced.html"><span>Chapter&nbsp;11</span></a> and <a href="13-quanteda-dfms.html"><span>Chapter&nbsp;13</span></a> show to combine documents to the <em>analytic</em> unit of analysis using <code>tokens_group()</code> or <code>dfm_group()</code>. Cleaning should be limited to removing <em>textual cruft</em>, such as page numbers if a document was converted from pdf format, and these are not of interest.</p>
</div>
</div>
</div>
</section>
<section id="applications" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="applications"><span class="header-section-number">9.3</span> Applications</h2>
<div class="callout-important callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Authors’ note:</strong> We should move the segmentation to the Advanced section, and use the Applications section for:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Creating a corpus from different input sources, including some minimal cleanup</li>
<li><input type="checkbox" disabled="" checked="">Accessing and assigning docvars</li>
<li><input type="checkbox" disabled="" checked="">Accessing and assigning corpus metadata</li>
<li><input type="checkbox" disabled="" checked=""><code>corpus_subset()</code>, from below, using <code>data_corpus_inaugural</code></li>
<li><input type="checkbox" disabled="" checked=""><code>corpus_sample()</code>, using <code>data_corpus_inaugural</code></li>
</ul>
</div>
</div>
</div>
<p>In this section, we will demonstrate how to create a corpus from different input sources, how to access and assign docvars and corpus metadata, how to subset documents from a corpus based on document-level variables, and how to draw a random sample of documents from a text corpus. We will use the corpus of US inaugural speeches, which is included in the <strong>quanteda</strong> package as <code>data_corpus_inaugural</code>.</p>
<section id="creating-a-corpus-from-different-input-sources" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="creating-a-corpus-from-different-input-sources"><span class="header-section-number">9.3.1</span> Creating a Corpus from Different Input Sources</h3>
<p>We can create a <em>quanteda</em> corpus from different input sources, for example a data frame, a <strong>tm</strong> corpus object, or a keyword-in-context object (<code>kwic</code>).</p>
<div class="callout-note callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>In <a href="05-acquiring-files.html"><span>Chapter&nbsp;5</span></a> we show how to use the <strong>readtext</strong> package for importing texts stored in various formats, e.g., PDF documents, Word documents, or spreadsheets. The output of the <code>readtext()</code> function is always a data frame, which can be easily transformed to a corpus object using <code>corpus()</code>.</p>
</div>
</div>
</div>
<p>Creating a corpus from a data frame or tibble object is straightforward. We use <code>corpus()</code> and determine the <code>text_field</code> that contains the text. By default, all remaining variables of the data frame will be added as docvars.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"quanteda"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create data frame for illustration purposes</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">letter_factor =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">each =</span> <span class="dv">2</span>)),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">some_ints =</span> 1L<span class="sc">:</span>6L,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">some_text =</span> <span class="fu">paste0</span>(<span class="st">"This is text number "</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">"."</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="fu">paste0</span>(<span class="st">"from_df_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          letter_factor some_ints              some_text
from_df_1             a         1 This is text number 1.
from_df_2             a         2 This is text number 2.
from_df_3             b         3 This is text number 3.
from_df_4             b         4 This is text number 4.
from_df_5             c         5 This is text number 5.
from_df_6             c         6 This is text number 6.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create corpus</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>corp_dataframe <span class="ot">&lt;-</span> <span class="fu">corpus</span>(dat, <span class="at">text_field =</span> <span class="st">"some_text"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(corp_dataframe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Corpus consisting of 6 documents, showing 6 documents:

      Text Types Tokens Sentences letter_factor some_ints
 from_df_1     6      6         1             a         1
 from_df_2     6      6         1             a         2
 from_df_3     6      6         1             b         3
 from_df_4     6      6         1             b         4
 from_df_5     6      6         1             c         5
 from_df_6     6      6         1             c         6</code></pre>
</div>
</div>
<p>We can also create a <strong>quanteda</strong> corpus from a <strong>tm</strong> corpus object. The following example uses the corpus <code>crude</code> corpus from the <strong>tm</strong> package which contains 20 exemplary news articles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load in a tm example VCorpus object</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(crude, <span class="at">package =</span> <span class="st">"tm"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create quanteda corpus</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>corp_newsarticles <span class="ot">&lt;-</span> <span class="fu">corpus</span>(crude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In addition, we can create a text corpus from a <code>kwic()</code> object. Keywords-in-context is covered extensively in <a href="15-exploring-kwic.html"><span>Chapter&nbsp;15</span></a>.</p>
<p>For example, we could extract all mentions of “freedom”, “war”, and “economy”, and the immediate context of 20 words from our corpus of hotel reviews, and convert the output to a new text corpus.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>kw_inaugural <span class="ot">&lt;-</span> data_corpus_inaugural <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tokens</span>(<span class="at">remove_separators =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kwic</span>(<span class="at">pattern =</span> <span class="fu">c</span>(<span class="st">"freedom"</span>, <span class="st">"war"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"econom*"</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">window =</span> <span class="dv">20</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">separator =</span> <span class="st">" "</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># check number of matches</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(kw_inaugural)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 478</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check how often each pattern was matched</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(kw_inaugural<span class="sc">$</span>pattern)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
freedom     war econom* 
    185     181     112 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert kwic object to a new text corpus</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>corp_kwic <span class="ot">&lt;-</span> <span class="fu">corpus</span>(kw_inaugural, <span class="at">split_context =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(corp_kwic, <span class="at">max_ndoc =</span> <span class="dv">5</span>, <span class="at">max_nchar =</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Corpus consisting of 478 documents and 1 docvar.
1789-Washington.L1841 :
"truth   more   thoroughly   established ..."

1797-Adams.L367 :
"The   zeal   and   ardor   of   the   pe..."

1801-Jefferson.L2619 :
"best   reliance   in   peace   and   for..."

1801-Jefferson.L2652 :
"  the   supremacy   of   the   civil   o..."

1801-Jefferson.L2756 :
"  all   abuses   at   the   bar   of   t..."

[ reached max_ndoc ... 473 more documents ]</code></pre>
</div>
</div>
</section>
<section id="inspecting-document-level-variables-and-metadata-of-a-corpus" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="inspecting-document-level-variables-and-metadata-of-a-corpus"><span class="header-section-number">9.3.2</span> Inspecting Document-Level Variables and Metadata of a Corpus</h3>
<p>Document-level variables are crucial for many text analysis projects. For instance, if we want to compare differences in issue emphasis in inaugural before and after World War II, we need a document-level variable specifying the year when a speech was delivered. We may also want to create a binary variable indicating whether a speech was delivered before or after World War II. Below, we provide examples on how to inspect document-level variables and how to create new docvars.</p>
<p>First, we load the packages and inspect the text corpus using <code>summary()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># provide summary of corpus and print document-level variables for the first six documents</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_corpus_inaugural, <span class="at">n =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Corpus consisting of 59 documents, showing 6 documents:

            Text Types Tokens Sentences Year  President FirstName
 1789-Washington   625   1537        23 1789 Washington    George
 1793-Washington    96    147         4 1793 Washington    George
      1797-Adams   826   2577        37 1797      Adams      John
  1801-Jefferson   717   1923        41 1801  Jefferson    Thomas
  1805-Jefferson   804   2380        45 1805  Jefferson    Thomas
    1809-Madison   535   1261        21 1809    Madison     James
                 Party
                  none
                  none
            Federalist
 Democratic-Republican
 Democratic-Republican
 Democratic-Republican</code></pre>
</div>
</div>
<p>The corpus consists of 59 documents. Each document is one inaugural speech delivered between 1789 and 2021.</p>
<p>The <code>meta()</code> function returns a named list containing the corpus-level information stored in the corpus, reflecting the standard set of metadata fields that we have chosen to use for <strong>quanteda</strong> objects. The “keywords” element of this list is a character vector containing five keywords.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">meta</span>(data_corpus_inaugural)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$description
[1] "Transcripts of all inaugural addresses delivered by United States Presidents, from Washington 1789 onward.  Data compiled by Gerhard Peters."

$source
[1] "Gerhard Peters and John T. Woolley. The American Presidency Project."

$url
[1] "https://www.presidency.ucsb.edu/documents/presidential-documents-archive-guidebook/inaugural-addresses"

$author
[1] "(various US Presidents)"

$keywords
[1] "political"     "US politics"   "United States" "presidents"   
[5] "presidency"   

$title
[1] "US presidential inaugural address speeches"</code></pre>
</div>
</div>
<p>We can also access the names of our docvars.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">docvars</span>(data_corpus_inaugural))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Year"      "President" "FirstName" "Party"    </code></pre>
</div>
</div>
<p>We see that the <code>Year</code> variable stores the year when each speech was delivered. We could create a binary variable <code>PrePostWW2</code> which distinguishes between speeches held before and after 1945. T</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use $ operator</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>data_corpus_inaugural<span class="sc">$</span>PrePostWW2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    data_corpus_inaugural<span class="sc">$</span>Year <span class="sc">&gt;</span> <span class="dv">1945</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Post World War II"</span>, <span class="st">"Pre World War II"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalent to</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(data_corpus_inaugural, <span class="st">"PrePostWW"</span>) <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">docvars</span>(data_corpus_inaugural, <span class="st">"Year"</span>) <span class="sc">&gt;</span> <span class="dv">1945</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Post World War II"</span>, <span class="st">"Pre World War II"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>There are multiple ways to access docvars in a <strong>quanteda</strong> object—here a corpus, but also other objects derived from a corpus such as tokens object, or separate objects such as dictionaries. These can be <code>docvars(data_corpus_inaugural, "Party")</code> or, for individual docvars, using the <code>$</code> operator known from lists or data.frames, i.e.&nbsp;<code>data_corpus_inaugural$Party</code>.</p>
</div>
</div>
</div>
</section>
<section id="subsetting-a-text-corpus" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="subsetting-a-text-corpus"><span class="header-section-number">9.3.3</span> Subsetting a Text Corpus</h3>
<p>Applying <code>corpus_subset()</code> to a corpus allows us to subset a text corpus based on values of document-level variables. We can filter, for instance, only speeches delivered by Democratic Presidents, speeches delivered after World War II, or speeches from selected presidents.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset only Republican Presidents</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>corp_democrats <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(data_corpus_inaugural,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                                Party <span class="sc">==</span> <span class="st">"Republican"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># subset speeches delivered after WW2</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>corp_postww2 <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(data_corpus_inaugural,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                              PrePostWW2 <span class="sc">==</span> <span class="st">"Post World War II"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>corp_postww2 <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(data_corpus_inaugural, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                              Year <span class="sc">&gt;</span> <span class="dv">1945</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># subset speeches delivered by Clinton, Obama, and Biden</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>corp_cob <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(data_corpus_inaugural, </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                          President <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Clinton"</span>, <span class="st">"Obama"</span>, <span class="st">"Biden"</span>))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># remove Biden's 2021 speech</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>corp_nobiden <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(data_corpus_inaugural,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>                              President <span class="sc">!=</span> <span class="st">"Biden"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-tip callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Usually, we use logical operators for subsetting a text corpus or creating a new document-level variable based on certain conditions. The most relevant logical operators are:</p>
<ul>
<li><code>&lt;</code>: less than</li>
<li><code>&lt;=</code>: less than or equal to</li>
<li><code>&gt;</code>: greater than</li>
<li><code>&gt;=</code>: greater than or equal to</li>
<li><code>==</code>: equal</li>
<li><code>!=</code>: not equal</li>
<li><code>!x</code>: not x (negation)</li>
<li><code>x | y</code>: x OR y</li>
<li><code>x &amp; y</code>: x AND y</li>
</ul>
</div>
</div>
</div>
</section>
<section id="randomly-sample-documents-from-a-corpus" class="level3" data-number="9.3.4">
<h3 data-number="9.3.4" class="anchored" data-anchor-id="randomly-sample-documents-from-a-corpus"><span class="header-section-number">9.3.4</span> Randomly Sample Documents From a Corpus</h3>
<p>Often, users may be interested in taking a random sample of documentsf from the text corpus. For example, a user may implement and test the workflow for a small, random subset of the documents, and only later run the analysis on the full text corpus.</p>
<p>The <code>corpus_sample()</code> function allows for sampling documents from a specified size (<code>size</code>) with or without replacement (<code>replace</code>), optionally stratified by grouping variables (<code>by</code>) or with probability weights (<code>prob</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 30 inaugural speeches without replacement</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>corp_sample30 <span class="ot">&lt;-</span> <span class="fu">corpus_sample</span>(data_corpus_inaugural, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check that the corpus consists of 30 documents</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ndoc</span>(corp_sample30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 15 speeches from before and 15 from after World War I</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>corp_sample_prepost <span class="ot">&lt;-</span> <span class="fu">corpus_sample</span>(data_corpus_inaugural,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">15</span>, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">by =</span> PrePostWW2)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check that corpus contains 15 pre- and 15 post-WW II documents</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(corp_sample_prepost<span class="sc">$</span>PrePostWW2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Post World War II  Pre World War II 
               15                15 </code></pre>
</div>
</div>
</section>
</section>
<section id="advanced" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="advanced"><span class="header-section-number">9.4</span> Advanced</h2>
<section id="corpus-cleaning" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="corpus-cleaning"><span class="header-section-number">9.4.1</span> Corpus “Cleaning”</h3>
<p>Why we favour a “conservative” approach, including storing documents in their natural format rather than an analytical format that can be created from the natural units, and especially not intervening to change documents in a corpus (such as removing punctuation).</p>
<p>We can discuss what constitutes recommended cleaning, and provide an example, perhaps from the debate transcript example.</p>
</section>
<section id="the-structure-of-a-quanteda-corpus-object" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="the-structure-of-a-quanteda-corpus-object"><span class="header-section-number">9.4.2</span> The Structure of a <strong>quanteda</strong> Corpus Object</h3>
<p>To be added…</p>
<ul>
<li>the structure of a corpus object, which is basically a character vector with special attributes.</li>
<li>Why to preserve these we need [] even when it’s mycorpus[seq_len(mycorpus)] &lt;- some_character_transformation</li>
</ul>
</section>
<section id="conversion-from-and-to-other-formats" class="level3" data-number="9.4.3">
<h3 data-number="9.4.3" class="anchored" data-anchor-id="conversion-from-and-to-other-formats"><span class="header-section-number">9.4.3</span> Conversion from and to Other Formats</h3>
<p>Below, we provide examples of converting a <strong>qunateda</strong> corpus to other objects. Converting a <code>corpus</code> object to a data frame could be useful, for instance, if you want to reshape a corpus to sentences and hand-code a sample of these sentences for validation purposes or a training set for supervised classifiers (see <a href="23-ml-classifiers.html"><span>Chapter&nbsp;23</span></a>). The example below shows how to sample 1,000 hotel reviews, and converting this corpus to a data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"TAUR"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">35</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>corp_TAhotels_sample <span class="ot">&lt;-</span> <span class="fu">corpus_sample</span>(data_corpus_TAhotels, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size =</span> <span class="dv">1000</span>, </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># convert corpus to data frame</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>dat_TAhotels_sample <span class="ot">&lt;-</span> <span class="fu">convert</span>(corp_TAhotels_sample, <span class="at">to =</span> <span class="st">"data.frame"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which will consist of the columns <code>doc_id</code>, containing the document name; <code>text</code>, containing the actual text of the document; and any docvars that were in the corpus, which in this example consist of <code>location</code> and <code>date</code>.</p>
<p>The resulting data frame consists of 1000 randomly sampled reviews and 3 columns: <code>doc_id</code>, containing the document name; <code>text</code>, containing the actual text of the document; and any docvars that were in the corpus (in our case <code>Rating</code>).</p>
<p>We can easily store this data frame as a spreadsheet, which can be useful when hand-code a selection of reviews (for instance, based on their sentiment).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store data frame as csv file with UTF-8 encoding and remove row names</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dat_TAhotels_sample_base_r, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"dat_TAhotels_sample.csv"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">fileEncoding =</span> <span class="st">"UTF-8"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the rio package allows us to store </span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the data frame in many different file formats</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rio"</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">export</span>(dat_TAhotels_sample_base_r,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">file =</span> <span class="st">"dat_TAhotels_sample.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-or-coercing-to-other-object-types" class="level3" data-number="9.4.4">
<h3 data-number="9.4.4" class="anchored" data-anchor-id="converting-or-coercing-to-other-object-types"><span class="header-section-number">9.4.4</span> Converting or Coercing to Other Object Types</h3>
<p>We can coerce an object to a text corpus (<code>as.corpus()</code>) or extract the texts from a corpus (<code>as.character()</code>). <code>as.corpus()</code> can only be applied to a <strong>quanteda</strong> corpus object and upgrades it to the newest format. This function can be handy for researchers who work with older <strong>quanteda</strong> objects. For transforming data frames or <strong>tm</strong> corpus objects into a <strong>quanteda</strong> corpus, you should use the <code>corpus()</code> function. The function <code>as.character()</code> returns the corpus text as a plain character vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>chars_TAhotels <span class="ot">&lt;-</span> <span class="fu">as.character</span>(data_corpus_TAhotels)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect character object</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(chars_TAhotels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Named chr [1:20491] "nice hotel expensive parking got good deal stay hotel anniversary, arrived late evening took advice previous re"| __truncated__ ...
 - attr(*, "names")= chr [1:20491] "text1" "text2" "text3" "text4" ...</code></pre>
</div>
</div>
</section>
<section id="changing-the-unit-of-analysis" class="level3" data-number="9.4.5">
<h3 data-number="9.4.5" class="anchored" data-anchor-id="changing-the-unit-of-analysis"><span class="header-section-number">9.4.5</span> Changing the Unit of Analysis</h3>
<p>In this section we will demonstrate the construction of a corpus that requires some reshaping. For this purpose, we will use the corpus of televised debate transcripts from the U.S. Presidential election campaign of 2020. Donald Trump and Joe Biden participated in two televised debates. The first debate took place in Cleveland, Ohio, on 29 September 2020. The two candidates met again in Nashville, Tennessee on 10 December.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> The corpus <strong>TAUR</strong> package contains this text corpus as <code>data_corpus_debates</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect text corpus</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_corpus_debates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Corpus consisting of 2 documents, showing 2 documents:

              Text Types Tokens Sentences             location       date
 Debate 2020-09-29  2450  24847      2039      Cleveland, Ohio 2020-09-29
 Debate 2020-10-22  2400  21727      1488 Nashville, Tennessee 2020-10-22</code></pre>
</div>
</div>
<p>The output of <code>summary(data_corpus_debates)</code> reveals that the corpus contains only two documents, i.e.&nbsp;the full debate transcript. The first document contains the transcript of the debate in Cleveland, consisting of 24,847 tokens, 2,450 types (i.e., unique tokens), and 2,039 sentences. The second debate in Nashville is slightly shorter (21,727 tokens and 2,400 types).</p>
<div class="callout-note callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>“Types” and “tokens” are specific linguistic terms that refer to the quantity and quality of the linguistic units found in a text. A <em>type</em> is a unique lexical unit, and a <em>token</em> is any lexical unit. Lexical units are most often words, but may also include punctuation characters, numerals, emoji, or even spaces. We cover this in greater detail in <a href="10-quanteda-tokens.html">Chapter&nbsp;<span>10</span></a>.</p>
</div>
</div>
</div>
<p>The debate corpus contains only two documents, each a transcript of a length debate that included many different statements by the presidential candidates and the moderator. The corpus recorded these “natural” speech units as a document, but in the case of transcripts, that is often not the “analytical” document unit that will meet the analyst’s needs.</p>
<p>To make the document unit align with our analytical purposes, we will need to reshape the corpus by segmenting it into individual statements, recording the speaker and the sequence in which the statement occurred, as new document-level variables.</p>
<p>The tool for this segmentation in <strong>quanteda</strong> is <code>corpus_segment()</code>. As discussed in <a href="08-quanteda-overview.html">Chapter&nbsp;<span>8</span></a>, the name of this function reflects the object that it takes as an input and produces as an output (a corpus) and the verb element describes the operation it will perform (segmentation). To perform this segmentation, we will rely on the presence in the transcript of regular patterns marking the introduction of a new statement. <strong>quanteda</strong> can take multiple forms of patterns, including a fixed match, a “glob” match, and a full regular expression match. Because we need to match a very specific pattern with more elements than a simple glob pattern can handle, we will need to use the regular expression “valuetype”. (For a brief primer on pattern matching and regular expressions see <a href="31-appendix-regex.html">Appendix&nbsp;<span>C</span></a>.)</p>
<p>In the transcript, a statement starts with the speaker’s name in ALL CAPS, followed by a colon. To match this marker of a new statement, we will use the regular expression <code>"\\s*[[:upper:]]+:\\s+"</code>. This identifies speaker names in ALL CAPS (<code>\\s*[[:upper:]]+</code>), indicating no or more spaces followed by one or more upper case words, followed by a colon (the literal<code>:</code>), followed by one or more white spaces <code>\\s+</code>. The <code>case_insensitive = FALSE</code> tells the pattern matcher to pay attention to case (how a word’s letters are capitalised or not).</p>
<p>By default, <code>corpus_segment()</code> will split the original documents into smaller documents corresponding to the segments preceded by the pattern, and extract the pattern found to a new variable for the split document (a docvar named <code>pattern</code>). It is also smart enough to record the original, longer document from which each split document originally came.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># segment text corpus to level of utterances</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>data_corpus_debatesseg <span class="ot">&lt;-</span> <span class="fu">corpus_segment</span>(data_corpus_debates, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">pattern =</span>  <span class="st">"</span><span class="sc">\\</span><span class="st">s*[[:upper:]]+:</span><span class="sc">\\</span><span class="st">s+"</span>, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">valuetype =</span> <span class="st">"regex"</span>, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">case_insensitive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># overview of text corpus; n = 4 prints only the first four documents</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_corpus_debatesseg, <span class="at">n =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Corpus consisting of 1208 documents, showing 4 documents:

                Text Types Tokens Sentences        location       date
 Debate 2020-09-29.1   139    251        13 Cleveland, Ohio 2020-09-29
 Debate 2020-09-29.2     6      6         1 Cleveland, Ohio 2020-09-29
 Debate 2020-09-29.3     5      5         1 Cleveland, Ohio 2020-09-29
 Debate 2020-09-29.4     3      3         1 Cleveland, Ohio 2020-09-29
     pattern
   WALLACE: 
 \n\nBIDEN: 
 \n\nTRUMP: 
 \n\nBIDEN: </code></pre>
</div>
</div>
<p>The new, split corpus, has turned the 2 original documents into 1,208 new docments. Note also that we have kept the <strong>quanteda</strong> naming conventions in assigning the new object a name that identifies it as data, as a corpus, and describes what it is. Because any function in <strong>quanteda</strong> that begins with <code>corpus_</code> will always take in and output a corpus, we know that this object will be a corpus.</p>
<p>In the split document, the new docvar <code>pattern</code> contains the pattern that we matched. Because this also included additional elements such as the spaces and the colon, however, it’s not as clean as we would prefer. Let’s turn this into a new <code>speaker</code> document-level variable by cleaning it up and renaming it. To make this easy, we will use the <strong>stringr</strong> for string manipulation, and the <strong>quanteda.tidy</strong> package for applying some <strong>dplyr</strong> functions from the “tidyverse” to manipulate the variables. Specifically, we will use <code>mutate()</code> to create a new <code>speaker</code> variable, and the <strong>stringr</strong> functions to remove empty whitespace (<code>str_trim()</code>) and the colon (<code>str_remove_all()</code>), and to change the names from UPPER CASE to Title Case (<code>str_to_title()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"stringr"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"quanteda.tidy"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>data_corpus_debatesseg <span class="ot">&lt;-</span> data_corpus_debatesseg <span class="sc">|&gt;</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">speaker =</span> stringr<span class="sc">::</span><span class="fu">str_trim</span>(pattern),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">speaker =</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(speaker, <span class="st">":"</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">speaker =</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(speaker)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we can use simple base R functions to inspect the count of utterances by speaker and debate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cross-table of speaker statements by debate</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_corpus_debatesseg<span class="sc">$</span>location,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>      data_corpus_debatesseg<span class="sc">$</span>speaker)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      
                       Biden Trump Wallace Welker
  Cleveland, Ohio        269   341     246      0
  Nashville, Tennessee    84   122       0    146</code></pre>
</div>
</div>
<p>We could further reshape the corpus to the level of sentences with <code>corpus_reshape()</code> if we are interested, for instance, in sentence-level sentiment or issue salience.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data_corpus_debatessent <span class="ot">&lt;-</span> <span class="fu">corpus_reshape</span>(data_corpus_debatesseg,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">to =</span> <span class="st">"sentences"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ndoc</span>(data_corpus_debatessent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3560</code></pre>
</div>
</div>
<p>The new text corpus moved from 1208 utterances to 3560 sentences. Using functions such as <strong>quanteda.textstat</strong>’s <code>textstat_summary()</code> we can retrieve summary statistics of the sentence-level corpus.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"quanteda.textstats"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>dat_summary_sents <span class="ot">&lt;-</span> <span class="fu">textstat_summary</span>(data_corpus_debatessent)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregated summary statistics</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat_summary_sents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   document             chars            sents       tokens         types      
 Length:3560        Min.   :  3.00   Min.   :1   Min.   : 1.0   Min.   : 1.00  
 Class :character   1st Qu.: 24.00   1st Qu.:1   1st Qu.: 6.0   1st Qu.: 6.00  
 Mode  :character   Median : 41.00   Median :1   Median :10.0   Median : 9.00  
                    Mean   : 55.32   Mean   :1   Mean   :12.4   Mean   :10.85  
                    3rd Qu.: 73.00   3rd Qu.:1   3rd Qu.:16.0   3rd Qu.:14.00  
                    Max.   :414.00   Max.   :1   Max.   :79.0   Max.   :56.00  
     puncts          numbers           symbols             urls        tags  
 Min.   : 0.000   Min.   :0.00000   Min.   :0.00000   Min.   :0   Min.   :0  
 1st Qu.: 1.000   1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0   1st Qu.:0  
 Median : 2.000   Median :0.00000   Median :0.00000   Median :0   Median :0  
 Mean   : 2.111   Mean   :0.07893   Mean   :0.01376   Mean   :0   Mean   :0  
 3rd Qu.: 3.000   3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0   3rd Qu.:0  
 Max.   :15.000   Max.   :4.00000   Max.   :2.00000   Max.   :0   Max.   :0  
     emojis 
 Min.   :0  
 1st Qu.:0  
 Median :0  
 Mean   :0  
 3rd Qu.:0  
 Max.   :0  </code></pre>
</div>
</div>
<div class="callout-tip callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Segmenting corpora into smaller units requires a common pattern across the documents. In the example above, we identified utterances based on the combination of a speaker’s surname in capital letters followed by a colon. Other corpora may include markers such as line breaks or headings that can be used to segment a corpus. When segmenting text corpora, we strongly recommend inspecting the resulting text corpus and spot-check that the segmentation worked as expected.</p>
</div>
</div>
</div>
</section>
<section id="reshaping-corpora-after-statistical-analyis-of-texts" class="level3" data-number="9.4.6">
<h3 data-number="9.4.6" class="anchored" data-anchor-id="reshaping-corpora-after-statistical-analyis-of-texts"><span class="header-section-number">9.4.6</span> Reshaping Corpora after Statistical Analyis of Texts</h3>
<p>In many applications, the unit of analysis of the text corpus differs from the dataset used for statistical analyses. For example, <span class="citation" data-cites="castanhosilva22eu">Castanho Silva and Proksch (<a href="references.html#ref-castanhosilva22eu" role="doc-biblioref">2021</a>)</span> study sentiment on European politics in tweets and parliamentary speeches. The authors construct a corpus of speeches and tweets that mention keywords relating to Europe or the EU and apply a sentiment dictionary to each document. The authors aggregate sentiment to the level of all relevant texts by a single politician, moving from over 100,000 Europe-related tweets and 20,000 Europe-related speeches to around 2500 observations. Each observation stores the sentiment by one Member of Parliament during their period of investigation. These sentiment scores are then used in regression models.</p>
<div class="callout-tip callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Applying the <code>group_by()</code> in combination with the <code>summarise()</code> functions of the <strong>dplyr</strong> packages allows you to reshape the output of a textual analysis, stored as a data frame, to a higher-level unit of analysis.</p>
</div>
</div>
</div>
</section>
</section>
<section id="further-reading" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="further-reading"><span class="header-section-number">9.5</span> Further Reading</h2>
<ul>
<li>Selecting document and considerations of “found data”: <span class="citation" data-cites="grimmer22textasdata">Grimmer, Roberts, and Stewart (<a href="references.html#ref-grimmer22textasdata" role="doc-biblioref">2022</a>, ch.&nbsp;4)</span></li>
<li>Definitions of document units and the reasons for and implications of redefining these: <span class="citation" data-cites="benoit2020text">Benoit (<a href="references.html#ref-benoit2020text" role="doc-biblioref">2020, pp480–481</a>, “Defining Documents and Choosing the Unit of Analysis”)</span></li>
<li>Adjusting strings: <span class="citation" data-cites="wickham17r4ds">Wickham and Grolemund (<a href="references.html#ref-wickham17r4ds" role="doc-biblioref">2017</a>, ch.&nbsp;14)</span></li>
</ul>
</section>
<section id="exercises" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">9.6</span> Exercises</h2>
<p>In the exercises below, we use a corpus of TripAdvisor hotel reviews, <code>data_corpus_TAhotels</code>, included in the <strong>TAUR</strong> package).</p>
<ol type="1">
<li>Identify the number of documents in <code>data_corpus_TAhotels</code>.</li>
<li>Subset the corpus by selecting only reviews with the maximum rating of 5.</li>
<li>Reshape this subsetted corpus to the level of sentences.</li>
<li>Explore <code>textstat_summary()</code> of the <strong>quanteda.textstats</strong> package. Apply the function to <code>data_corpus_TAhotels</code> and assign it to an object called <code>tstat_sum_TAhotels</code>.</li>
<li>What are the average, median, minimum, and maximum document lengths?</li>
<li>Advanced: use <code>data_corpus_TAhotels</code> filter only speeches consisting of at least 300 tokens by combining <code>ntoken()</code> and <code>corpus_subset()</code>.</li>
<li>Create a new document-level variable <code>RankingRecoded</code> that which splits up the rankings into three categories: Negative (Ranking = 1 and 2), Neutral (Ranking = 3), and Positive (Ranking = 4 and 5). Which of the three categories is the most frequent one?</li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-benoit2020text" class="csl-entry" role="doc-biblioentry">
Benoit, Kenneth. 2020. <span>“Text as Data: An Overview.”</span> In <em>Handbook of Research Methods in Political Science and International Relations</em>, edited by Luigi Curini and Robert Franzese, 461–97. Thousand Oaks: Sage.
</div>
<div id="ref-benoit19sophistication" class="csl-entry" role="doc-biblioentry">
Benoit, Kenneth, Kevin Munger, and Arthur Spirling. 2019. <span>“Measuring and Explaining Political Sophistication Through Textual Complexity.”</span> <em>American Journal of Political Science</em> 63 (2): 491–508. <a href="https://doi.org/10.1111/ajps.12423">https://doi.org/10.1111/ajps.12423</a>.
</div>
<div id="ref-boussalis21reactions" class="csl-entry" role="doc-biblioentry">
Boussalis, Constantine, Travis G. Coan, Mirya R. Holman, and Stefan Müller. 2021. <span>“Gender, Candidate Emotional Expression, and Voter Reactions During Televised Debates.”</span> <em>American Political Science Review</em> 115 (4): 1242–57. <a href="https://doi.org/10.1017/S0003055421000666">https://doi.org/10.1017/S0003055421000666</a>.
</div>
<div id="ref-castanhosilva22eu" class="csl-entry" role="doc-biblioentry">
Castanho Silva, Bruno, and Sven-Oliver Proksch. 2021. <span>“Politicians Unleashed? Political Communication on Twitter and in Parliament in Western Europe.”</span> <em>Political Science Research and Methods</em> published ahead of print (doi: 10.1017/psrm.2021.36). <a href="https://doi.org/10.1017/psrm.2021.36">https://doi.org/10.1017/psrm.2021.36</a>.
</div>
<div id="ref-grimmer22textasdata" class="csl-entry" role="doc-biblioentry">
Grimmer, Justin, Margaret E. Roberts, and Brandon M. Stewart. 2022. <em>Text as Data: The Promise and Pitfalls of Automatic Content Analysis Methods for Political Texts: A New Framework for Machine Learning and the Social Sciences</em>. Princeton: Princeton University Press.
</div>
<div id="ref-herzog15cuts" class="csl-entry" role="doc-biblioentry">
Herzog, Alexander, and Kenneth Benoit. 2015. <span>“The Most Unkindest Cuts: Speaker Selection and Expressed Goverment Dissent During Economic Crisis.”</span> <em>The Journal of Politics</em> 77 (4): 1157–75. <a href="https://doi.org/10.1086/682670">https://doi.org/10.1086/682670</a>.
</div>
<div id="ref-wickham17r4ds" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. Sebastopol: O’Reilly. <a href="https://r4ds.had.co.nz">https://r4ds.had.co.nz</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The transcripts are available at https://www.presidency.ucsb.edu/documents/presidential-debate-case-western-reserve-university-cleveland-ohio and https://www.presidency.ucsb.edu/documents/presidential-debate-belmont-university-nashville-tennessee-0.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./08-quanteda-overview.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introducing the <strong>quanteda</strong> Package</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./10-quanteda-tokens.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Creating and Managing tokens</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>